<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CricScanner Live</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
</head>

<body class="bg-slate-950 text-slate-100 min-h-screen font-sans">
  <main class="max-w-6xl mx-auto px-6 py-10">
    <h1 class="text-4xl font-bold text-emerald-400 mb-10 flex items-center gap-2">
      üèè CricScanner Live
    </h1>

    <!-- üåç Popular Tournaments -->
    <section class="mb-10">
      <h2 class="text-2xl font-semibold mb-4 text-white">ALL Tournaments</h2>
      <div id="tournaments" class="flex flex-wrap gap-3"></div>
    </section>

    <!-- üèè Match Section -->
    <section>
      <h2 class="text-2xl font-semibold mb-3 text-white">Matches</h2>

      <!-- Tabs -->
      <div class="flex gap-3 mb-6">
        <button class="tab-btn bg-emerald-500 px-4 py-2 rounded-full font-semibold text-slate-900" data-status="Live">Live</button>
        <button class="tab-btn bg-slate-700 px-4 py-2 rounded-full font-semibold" data-status="Upcoming">Upcoming</button>
        <button class="tab-btn bg-slate-700 px-4 py-2 rounded-full font-semibold" data-status="Completed">Recent</button>
      </div>

      <!-- Matches Wrapper -->
      <div id="matches" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5"></div>
    </section>
  </main>

  <script>
    const { DateTime } = luxon;
    const matchesContainer = document.getElementById("matches");
    const tournamentsContainer = document.getElementById("tournaments");
    const tabButtons = document.querySelectorAll(".tab-btn");

    // üèè Get logo for team (major teams get real logo, others get default)
    function getLogo(teamName) {
      if (!teamName) return "/logos/default.png";
      const safe = teamName.toLowerCase().replace(/\s+/g, "");
      const knownTeams = [
        "india", "australia", "england", "pakistan", "srilanka", "bangladesh",
        "newzealand", "southafrica", "westindies", "afghanistan", "zimbabwe",
        "nepal", "ireland", "scotland", "netherlands"
      ];
      if (knownTeams.includes(safe)) return `/logos/${safe}.png`;
      return "/logos/default.png";
    }

    // üéØ Render tournaments
    function renderTournaments() {
      const tournaments = JSON.parse(localStorage.getItem("cricscanner_tournaments") || "[]");
      tournamentsContainer.innerHTML = tournaments.length
        ? tournaments.map(t =>
            `<div class="px-5 py-2 bg-slate-800 text-slate-200 rounded-full hover:bg-emerald-500 hover:text-slate-900 transition">${t.name}</div>`
          ).join("")
        : `<p class="text-slate-400">No tournaments available right now.</p>`;
    }

    // üèè Render matches by status
    function renderMatches(status) {
      const matches = JSON.parse(localStorage.getItem("cricscanner_matches") || "[]");
      const filtered = matches.filter(m => m.status && m.status.toLowerCase().includes(status.toLowerCase()));

      matchesContainer.innerHTML = filtered.length
        ? filtered.map(m => `
            <div class="p-5 bg-slate-900 border border-slate-800 rounded-2xl shadow hover:shadow-lg transition relative">
              <div class="flex justify-between mb-2">
                <span class="text-xs uppercase tracking-wider text-red-400">${m.status || "Match"}</span>
                <span class="text-xs uppercase text-slate-400">${m.matchType || ""}</span>
              </div>
              <div class="flex items-center mb-1">
                <img src="${getLogo(m.teamA)}" alt="${m.teamA}" class="w-6 h-6 rounded-full mr-2">
                <span class="font-semibold text-white">${m.teamA || ""} ${m.scoreA || ""}</span>
              </div>
              <div class="flex items-center mb-2">
                <img src="${getLogo(m.teamB)}" alt="${m.teamB}" class="w-6 h-6 rounded-full mr-2">
                <span class="font-semibold text-white">${m.teamB || ""} ${m.scoreB || ""}</span>
              </div>
              <p class="text-slate-400 text-sm mb-3">${m.statusNote || "No update available."}</p>
              <button class="w-full bg-emerald-500 hover:bg-emerald-600 text-slate-900 font-semibold py-2 rounded-full transition">
                View Full Scorecard
              </button>
            </div>
          `).join("")
        : `<p class="text-slate-500">No ${status.toLowerCase()} matches right now.</p>`;
    }

    // üß† On load + tab switching
    document.addEventListener("DOMContentLoaded", () => {
      renderTournaments();
      renderMatches("Live");

      tabButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          tabButtons.forEach(b => b.classList.remove("bg-emerald-500", "text-slate-900"));
          btn.classList.add("bg-emerald-500", "text-slate-900");
          renderMatches(btn.dataset.status);
        });
      });

      // Auto refresh on new data saved
      window.addEventListener("storage", e => {
        if (e.key === "cricscanner_matches") {
          console.log("üîÑ Matches updated");
          renderMatches("Live");
        }
      });
    });
  </script>

  <!-- Auto updater (keeps data fresh) -->
  <script src="/public/js/auto-updater.js"></script>
</body>
</html>
